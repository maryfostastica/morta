<!DOCTYPE html>
<!-- saved from url=(0065)file:///C:/Users/1118937/Downloads/TRABALHO%20DE%20DIW/index.html -->
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Lab FakeDB</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="./Lab FakeDB_files/style.css">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha256-3edrmyuQ0w65f8gfBsqowzjJe2iM6n0nKciPUp8y+7E="
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
</head>

<body onload="init()" class="">
    <h1>BUSQUE BOOKS</h1>
    <div class="container">

        <!-- Button trigger modal -->
        <button type="button" onclick="clearform()" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
            Cadastre um novo livro !
        </button>

        <!-- Modal -->
        <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true"
            style="display: none;">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Cadastro de Livros</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form id="form-contato">
                            <div class="row">
                                <div id="msg" class="col-sm-10 offset-sm-1 ">
                                    <div class="alert alert-info" id="textblue">Preencha os dados</div>
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-sm-3">
                                    <label for="inputId">Id</label>
                                    <input type="text" class="form-control" id="inputId" placeholder="ID" disabled="">
                                </div>
                                <div class="col-sm-6">
                                    <label for="inputNome">Nome (*)</label>
                                    <input type="text" class="form-control" id="inputNome" required="" placeholder="Informe o nome do livro">
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-sm-7">
                                    <label for="inputAutor">Autor (*)</label>
                                    <input type="text" class="form-control" id="inputAutor" required="" placeholder="Autor">
                                </div>
                                <div class="col-sm-6">
                                    <label for="inputEditora">Editora (*)</label>
                                    <input type="text" class="form-control" id="inputEditora" required="" placeholder="Informe a Editora">
                                </div>
                                <div class="col-sm-7 mt-2">
                                    <label for="inputGênero">Gênero (*)</label>
                                    <input type="text" class="form-control" id="inputGenero" required="" placeholder="Gênero">
                                </div>
                                <div class="col-sm-4 mt-2">
                                    <label for="inputAvaliação">Avaliação (*)</label>
                                    <input type="text" class="form-control" id="inputAvaliacao" required="" placeholder="Dê uma nota de 0 a 10">
                                </div>
                                <div class="col-sm-4 mt-2">
                                    <label for="inputEdicao">Edição(*)</label>
                                    <input type="text" class="form-control" id="inputEdicao" required="" placeholder="Edição">
                                </div>
                                <div class="col-sm-7 mt-2">
                                    <label for="inputImagem">Imagem(*)</label>
                                    <input type="text" class="form-control" id="inputImagem" required="" placeholder="Informe o link da imagem">
                                </div>
                            </div>
                        </form>
                        <div class="form-group row">
                            <div class="col-sm-5 mt-2">
                                <small>(*) Campos obrigatórios</small>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-12">
                                <input type="button" class="btn btn-success" id="btnInsert" value="Inserir">
                                <input type="button" class="btn btn-warning hide" id="btnUpdate" value="Alterar">
                                <input type="button" class="btn btn-secondary" id="btnClear" value="Limpar Form">
                                <input type="button" class="btn btn-danger hide" id="btnDelete" value="Excluir">
                            </div>
                        </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <!--Modal de visualização-->
        <!-- Modal -->
        <div class="modal fade" id="modv" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" style="display: none;">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Cadastro de Livros</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form id="form-visu">
                            <div class="row">
                                <div id="msg" class="col-sm-10 offset-sm-1 ">
                                    <div class="alert alert-info" id="textblue">Preencha os dados</div>
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-sm-3">
                                    <label for="inputId">Id</label>
                                    <input type="text" class="form-control" id="inputIdm" placeholder="ID" disabled="">
                                </div>
                                <div class="col-sm-6">
                                    <label for="inputNome">Nome</label>
                                    <input type="text" class="form-control" id="inputNomem" required="" disabled="" placeholder="Informe o nome do livro">
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-sm-7">
                                    <label for="inputAutor">Autor</label>
                                    <input type="text" class="form-control" id="inputAutorm" required="" disabled="" placeholder="Autor">
                                </div>
                                <div class="col-sm-6">
                                    <label for="inputEditora">Editora</label>
                                    <input type="text" class="form-control" id="inputEditoram" required="" disabled="" placeholder="Informe a Editora">
                                </div>
                                <div class="col-sm-7 mt-2">
                                    <label for="inputGênero">Gênero</label>
                                    <input type="text" class="form-control" id="inputGenerom" required="" disabled="" placeholder="Gênero">
                                </div>
                                <div class="col-sm-4 mt-2">
                                    <label for="inputAvaliação">Avaliação</label>
                                    <input type="text" class="form-control" id="inputAvaliacaom" required="" disabled="" placeholder="Dê uma nota de 0 a 10">
                                </div>
                                <div class="col-sm-4 mt-2">
                                    <label for="inputEdicao">Edição</label>
                                    <input type="text" class="form-control" id="inputEdicaom" required="" disabled="" placeholder="Edição">
                                </div>
                                <div class="col-sm-7 mt-2">
                                    <label for="imgp">Imagem</label>
                                    <img id="imgp">
                                </div>
                            </div>
                        </form>
                        <div class="form-group row">
                            <div class="col-sm-5 mt-2">
                                <small>(*) Campos obrigatórios</small>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-12">
                                <input type="button" class="btn btn-warning" onclick="alterar()" value="Alterar">
                            </div>
                        </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
                        <button type="button" class="btn btn-primary">Salvar</button>
                    </div>
                </div>
            </div>
        </div>
        <!--==================================-->

        <div class="row">
            <div class="col-sm-12">
                <table id="grid-contatos" class="table table-striped">
                    <thead>
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">Nome</th>
                            <th scope="col">Autor</th>
                        </tr>
                    </thead>
                    <tbody id="table-livro">
                        <tr>
                            <td scope="row"></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <script src="fakedb.js"></script>
    <script>
        function exibeContatos() {
            // Remove todas as linhas do corpo da tabela
            $("#table-livro").html("");

            // Popula a tabela com os registros do banco de dados
            for (i = 0; i < db.data.length; i++) {
                let livro = db.data[i];
                $("#table-livro").append(`<tr><td scope="row">${livro.id}</td><td>${livro.nome}</td><td>${livro.autor}</td></tr>`);
            }
        }

        function clearform() {
            // Limpa o formulario
            $("#form-contato")[0].reset();

        }

        function init() {
            // Adiciona funções para tratar os eventos 
            $("#btnInsert").click(function () {
                // Verfica se o formulário está preenchido corretamente
                if (!$('#form-contato')[0].checkValidity()) {
                    displayMessage("Preencha os dados corretamente.");
                    return;
                }

                // Obtem os valores dos campos do formulário
                let campoNome = $("#inputNome").val();
                let campoAutor = $("#inputAutor").val();
                let campoAvaliacao = $('#inputAvaliacao').val();
                let campoEditora = $("#inputEditora").val();
                let campoGenero = $('#inputGenero').val();
                let campoEdicao = $('#inputEdicao').val();
                let campoImagem = $('#inputImagem').val();
                let livro = { nome: campoNome, autor: campoAutor, editora: campoEditora, genero: campoGenero, avaliacao: campoAvaliacao, edicao: campoEdicao, imagem: campoImagem };

                insertContato(livro);

                // Reexibe os contatos
                exibeContatos();
                $('#exampleModal').modal('toggle');

                // Limpa o formulario
                $("#form-contato")[0].reset();
            });

            // Intercepta o click do botão Alterar
            $("#btnUpdate").click(function () {
                // Obtem os valores dos campos do formulário
                let campoId = $("#inputId").val();
                if (campoId == "") {
                    displayMessage("Selecione um contato para ser alterado.");
                    return;
                }
                let campoNome = $("#inputNome").val();
                let campoAutor = $("#inputAutor").val();
                let campoAvaliacao = $("#inputAvaliacao").val();
                let campoEditora = $("#inputEditora").val();
                let campoGenero = $("#inputGenero").val();
                let campoEdicao = $("#inputEdicao").val();
                let campoImagem = $("#inputImagem").val();
                let livro = { nome: campoNome, autor: campoAutor, editora: campoEditora, genero: campoGenero, avaliacao: campoAvaliacao, edicao: campoEdicao, imagem: campoImagem };

                updateContato(parseInt(campoId), livro);

                // Reexibe os contatos
                exibeContatos();
                $('#exampleModal').modal('toggle');

                // Limpa o formulario
                $("#form-contato")[0].reset();
            });

            // Intercepta o click do botão Excluir
            $("#btnDelete").click(function () {
                let campoId = $("#inputId").val();
                if (campoId == "") {
                    displayMessage("Selecione um contato a ser excluído.");
                    return;
                }
                deleteContato(parseInt(campoId));

                // Reexibe os contatos
                exibeContatos();

                // Limpa o formulario
                $("#form-contato")[0].reset();
            });

            // Intercepta o click do botão Listar Contatos
            $("#btnClear").click(function () {
                $("#form-contato")[0].reset();
            });

            // Oculta a mensagem de aviso após alguns segundos
            $('#msg').bind("DOMSubtreeModified", function () {
                window.setTimeout(function () {
                    $(".alert").fadeTo(500, 0).slideUp(500, function () {
                        $(this).remove();
                    });
                }, 5000);
            });

            // Preenche o formulário quando o usuario clicar em uma linha da tabela 
            $("#grid-contatos").on("click", "tr", function (e) {
                let linhaContato = this;
                let id = linhaContato.childNodes[0].firstChild.nodeValue;
                $('#modv').modal('show');


                let bs = db.data[db.data.map(obj => obj.id).indexOf(parseInt(id))];
                $("#inputIdm").val(id);
                $("#inputNomem").val(bs.nome);
                $("#inputAutorm").val(bs.autor);
                $("#inputEditoram").val(bs.editora);
                $("#inputGenerom").val(bs.genero);
                $("#inputEdicaom").val(bs.edicao);
                $("#imgp").attr('src', bs.imagem);
                $("#inputAvaliacaom").val(bs.avaliacao);
            });
            exibeContatos();
            $('#exampleModal').on('hidden.bs.modal', function () {
                $('#btnInsert').css("display", "block");
                $('.hide').css("display", "none");
            });
        }
        function alterar() {
            let id = $("#inputIdm").val();
            console.log(id);


            let bs = db.data[db.data.map(obj => obj.id).indexOf(parseInt(id))];
            $("#inputId").val(id);
            $("#inputNome").val(bs.nome);
            $("#inputAutor").val(bs.autor);
            $("#inputEditora").val(bs.editora);
            $("#inputGenero").val(bs.genero);
            $("#inputEdicao").val(bs.edicao);
            $("#inputImagem").val(bs.imagem);
            $("#inputAvaliacao").val(bs.avaliacao);

            $('#modv').modal('toggle');
            $('#btnInsert').css("display", "none");
            $('#btnUpdate').css("display", "block");
            $('#btnDelete').css("display", "block");
            $('#exampleModal').modal('show');
        }
    </script>


</body>

</html>